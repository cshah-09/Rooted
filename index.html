<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rooted</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500&family=DM+Sans:wght@400;500&family=Caveat:wght@500&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    height:100vh;
    font-family:'DM Sans',sans-serif;
    background:
      radial-gradient(circle at 20% 20%, #fce7f3 0%, transparent 40%),
      radial-gradient(circle at 80% 80%, #ede9fe 0%, transparent 40%),
      #faf7f2;
    display:flex;
    flex-direction:column;
    align-items:center;
    text-align:center;
    overflow:hidden;
    position:relative;
}

h1{
    font-family:'Playfair Display',serif;
    font-size:2.3rem;
    margin-top:25px;
    margin-bottom:10px;
    color:#2e2e2e;
}

#task{
    font-family:'Caveat',cursive;
    font-size:1.9rem;
    color:#444;
    max-width:360px;
    margin:35px auto 25px auto;
    line-height:1.4;
}

button{
    padding:14px 30px;
    border:none;
    border-radius:30px;
    font-family:'Caveat',cursive;
    font-size:1.5rem;
    background:#ffffffcc;
    backdrop-filter:blur(6px);
    cursor:pointer;
    transition:all 0.3s ease;
}

button:hover{
    transform:translateY(-2px);
    background:#ffffff;
}

#message{
    margin-top:15px;
    font-size:0.95rem;
    color:#666;
}

#counter{
    position:absolute;
    top:20px;
    right:25px;
    font-size:0.9rem;
    color:#444;
}

.bottom-section{
    position:absolute;
    bottom:0;
    width:100%;
    display:flex;
    justify-content:center;
    align-items:flex-end;
    padding-bottom:20px;
}
</style>
</head>

<body>

<div id="counter"></div>

<h1>Rooted</h1>

<div id="task"></div>

<button id="completeBtn" onclick="completeTask()">Task Completed!!</button>

<div id="message"></div>

<div class="bottom-section">
    <div id="plant"></div>
</div>

<script>
const tasks = [
"Drink 6 glasses of water today.",
"Declutter one small space.",
"Go for a 15 min walk.",
"No scrolling 30 mins before bed.",
"Eat one clean meal.",
"Text someone you appreciate.",
"Plan tomorrow in 3 bullet points."
];

const now = new Date();
const pst = new Date(now.toLocaleString("en-US",{timeZone:"America/Los_Angeles"}));
const todayKey = pst.toDateString();

let data = JSON.parse(localStorage.getItem("rooted")) || {
    weekStart: todayKey,
    completedDays: [],
    trees: 0
};

function isNewWeek(){
    const start = new Date(data.weekStart);
    const diff = Math.floor((pst - start)/(1000*60*60*24));
    return diff >= 7;
}

function resetWeekIfNeeded(){
    if(isNewWeek()){
        if(data.completedDays.length === 7){
            data.trees += 1;
        }
        data.weekStart = todayKey;
        data.completedDays = [];
        document.getElementById("message").innerText="New week. New growth.";
    }
}

resetWeekIfNeeded();

const dayIndex = Math.floor((pst - new Date(data.weekStart))/(1000*60*60*24));
document.getElementById("task").innerText = tasks[dayIndex] || "Come back tomorrow ðŸŒ¿";

function completeTask(){
    if(data.completedDays.includes(todayKey)){
        document.getElementById("message").innerText="heyy, only one task a day ðŸŒ¿";
        return;
    }

    data.completedDays.push(todayKey);
    localStorage.setItem("rooted",JSON.stringify(data));

    renderPlant();

    document.getElementById("message").innerText="Proud of you ðŸŒ±";
    document.getElementById("completeBtn").style.display="none";
}

function renderPlant(){
    const stage = data.completedDays.length;
    const plant = document.getElementById("plant");
    const canopySize = 35 + stage*8;

    plant.innerHTML = `
    <svg width="260" height="260">
        <!-- Soil -->
        <ellipse cx="130" cy="220" rx="90" ry="25" fill="#9c6b4f"/>
        <ellipse cx="130" cy="215" rx="90" ry="20" fill="#b07a5a"/>

        <!-- Trunk -->
        <rect x="123" y="130" width="14" height="80" rx="4" fill="#8b5e3c"/>

        <!-- Canopy -->
        <circle cx="130" cy="120" r="${canopySize}" fill="#b8e6c1"/>
        <circle cx="105" cy="125" r="${canopySize*0.75}" fill="#c9f0d2"/>
        <circle cx="155" cy="125" r="${canopySize*0.75}" fill="#c9f0d2"/>
        <circle cx="130" cy="95" r="${canopySize*0.65}" fill="#d7f7df"/>

        ${data.trees===0 && stage>=4 ? `<circle cx="140" cy="110" r="6" fill="#ff6b6b"/>` : ``}
    </svg>
    `;
}

renderPlant();

document.getElementById("counter").innerText="Total Trees Planted â†’ "+data.trees;

if(data.completedDays.includes(todayKey)){
    document.getElementById("message").innerText="heyy, only one task a day ðŸŒ¿";
    document.getElementById("completeBtn").style.display="none";
}
</script>

</body>
</html>
